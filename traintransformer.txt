========================start from log/tmp/train_ours/log_refine_transformer.
=================Training Information==============
start from log/tmp/train_ours/log_refine_transformer
box from data/adaptive/cocobu_box
input json data/tmp/4/cocotalk.json
attributes from data/adaptive/cocobu_att
features from data/adaptive/cocobu_fc
batch size =10
#GPU=1
DataLoader loading json file:  data/tmp/4/cocotalk.json
vocab size is  10369
DataLoader loading h5 file:  data/adaptive/cocobu_fc data/adaptive/cocobu_att data/adaptive/cocobu_box data/tmp/4/cocotalk_label.h5
max sequence length in data is 16
read 123287 image features
assigned 113287 images to split train
assigned 5000 images to split val
assigned 5000 images to split test
write summary to log/tmp/train_ours/log_refine_transformer_rl
Load model information log/tmp/train_ours/log_refine_transformer/infos_24.pkl
==================start from 25 epoch================
log/tmp/train_ours/log_refine_transformer/infos_24.pkl
Loading model model_24.pth......
Loading optimizer............
25th Epoch Training starts now!
SPICE evaluation took: 1.587 min
Evaluation Done! 0.0mins 56.79923892021179 seconds
loading annotations into memory...
Done (t=0.28s)
creating index...
index created!
using 5000/5000 predictions
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr285000_transformer_val.json
Loading and preparing results...
DONE (t=0.02s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 45467, 'reflen': 46148, 'guess': [45467, 40467, 35467, 30467], 'correct': [35730, 20280, 9897, 4593]}
ratio: 0.9852431307965462
Bleu_1: 0.774
Bleu_2: 0.618
Bleu_3: 0.472
Bleu_4: 0.353
computing METEOR score...
METEOR: 0.271
computing Rouge score...
ROUGE_L: 0.567
computing CIDEr score...
CIDEr: 1.131
computing SPICE score...
SPICE: 0.204
computing WMD score...
WMD: 0.243
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr285000_transformer_val.json
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos.pkl
Save training historyes to log/tmp/train_ours/log_refine_transformer_rl/histories_transformer.pkl
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model_best.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer_best.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos_best.pkl
update best model at 285000 iteration--25 epoch
SPICE evaluation took: 1.539 min
Evaluation Done! 0.0mins 56.4537148475647 seconds
loading annotations into memory...
Done (t=0.48s)
creating index...
index created!
using 5000/5000 predictions
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr288000_transformer_val.json
Loading and preparing results...
DONE (t=0.03s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 45789, 'reflen': 46314, 'guess': [45789, 40789, 35789, 30789], 'correct': [36232, 20664, 10278, 4808]}
ratio: 0.9886643347583671
Bleu_1: 0.782
Bleu_2: 0.626
Bleu_3: 0.481
Bleu_4: 0.362
computing METEOR score...
METEOR: 0.275
computing Rouge score...
ROUGE_L: 0.570
computing CIDEr score...
CIDEr: 1.179
computing SPICE score...
SPICE: 0.211
computing WMD score...
WMD: 0.251
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr288000_transformer_val.json
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos.pkl
Save training historyes to log/tmp/train_ours/log_refine_transformer_rl/histories_transformer.pkl
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model_best.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer_best.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos_best.pkl
update best model at 288000 iteration--25 epoch
SPICE evaluation took: 1.534 min
Evaluation Done! 0.0mins 56.5777473449707 seconds
loading annotations into memory...
Done (t=0.51s)
creating index...
index created!
using 5000/5000 predictions
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr291000_transformer_val.json
Loading and preparing results...
DONE (t=0.03s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 45805, 'reflen': 46395, 'guess': [45805, 40805, 35805, 30805], 'correct': [36332, 20857, 10573, 5094]}
ratio: 0.9872831124043328
Bleu_1: 0.783
Bleu_2: 0.629
Bleu_3: 0.487
Bleu_4: 0.370
computing METEOR score...
METEOR: 0.278
computing Rouge score...
ROUGE_L: 0.575
computing CIDEr score...
CIDEr: 1.200
computing SPICE score...
SPICE: 0.214
computing WMD score...
WMD: 0.255
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr291000_transformer_val.json
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos.pkl
Save training historyes to log/tmp/train_ours/log_refine_transformer_rl/histories_transformer.pkl
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model_best.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer_best.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos_best.pkl
update best model at 291000 iteration--25 epoch
SPICE evaluation took: 1.548 min
Evaluation Done! 0.0mins 57.77362537384033 seconds
loading annotations into memory...
Done (t=0.39s)
creating index...
index created!
using 5000/5000 predictions
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr294000_transformer_val.json
Loading and preparing results...
DONE (t=0.03s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 45890, 'reflen': 46424, 'guess': [45890, 40890, 35890, 30890], 'correct': [36537, 20991, 10561, 5082]}
ratio: 0.9884973289677541
Bleu_1: 0.787
Bleu_2: 0.632
Bleu_3: 0.488
Bleu_4: 0.371
computing METEOR score...
METEOR: 0.279
computing Rouge score...
ROUGE_L: 0.575
computing CIDEr score...
CIDEr: 1.207
computing SPICE score...
SPICE: 0.214
computing WMD score...
WMD: 0.255
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr294000_transformer_val.json
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos.pkl
Save training historyes to log/tmp/train_ours/log_refine_transformer_rl/histories_transformer.pkl
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model_best.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer_best.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos_best.pkl
update best model at 294000 iteration--25 epoch
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model_25.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer_25.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos_25.pkl
26th Epoch Training starts now!
SPICE evaluation took: 1.597 min
Evaluation Done! 0.0mins 57.3125102519989 seconds
loading annotations into memory...
Done (t=0.45s)
creating index...
index created!
using 5000/5000 predictions
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr297000_transformer_val.json
Loading and preparing results...
DONE (t=0.03s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 45642, 'reflen': 46339, 'guess': [45642, 40642, 35642, 30642], 'correct': [36471, 21071, 10619, 5047]}
ratio: 0.9849586741189714
Bleu_1: 0.787
Bleu_2: 0.634
Bleu_3: 0.490
Bleu_4: 0.372
computing METEOR score...
METEOR: 0.279
computing Rouge score...
ROUGE_L: 0.578
computing CIDEr score...
CIDEr: 1.209
computing SPICE score...
SPICE: 0.216
computing WMD score...
WMD: 0.257
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr297000_transformer_val.json
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos.pkl
Save training historyes to log/tmp/train_ours/log_refine_transformer_rl/histories_transformer.pkl
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model_best.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer_best.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos_best.pkl
update best model at 297000 iteration--26 epoch
SPICE evaluation took: 1.699 min
Evaluation Done! 0.0mins 52.62910056114197 seconds
loading annotations into memory...
Done (t=0.55s)
creating index...
index created!
using 5000/5000 predictions
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr300000_transformer_val.json
Loading and preparing results...
DONE (t=0.03s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 45894, 'reflen': 46453, 'guess': [45894, 40894, 35894, 30894], 'correct': [36585, 21043, 10566, 5024]}
ratio: 0.9879663315609114
Bleu_1: 0.788
Bleu_2: 0.633
Bleu_3: 0.488
Bleu_4: 0.370
computing METEOR score...
METEOR: 0.279
computing Rouge score...
ROUGE_L: 0.576
computing CIDEr score...
CIDEr: 1.200
computing SPICE score...
SPICE: 0.215
computing WMD score...
WMD: 0.257
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr300000_transformer_val.json
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos.pkl
Save training historyes to log/tmp/train_ours/log_refine_transformer_rl/histories_transformer.pkl
SPICE evaluation took: 1.692 min
Evaluation Done! 0.0mins 55.3999457359314 seconds
loading annotations into memory...
Done (t=0.69s)
creating index...
index created!
using 5000/5000 predictions
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr303000_transformer_val.json
Loading and preparing results...
DONE (t=0.03s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 45334, 'reflen': 46076, 'guess': [45334, 40334, 35334, 30334], 'correct': [36159, 20868, 10498, 5016]}
ratio: 0.9838961715426473
Bleu_1: 0.785
Bleu_2: 0.632
Bleu_3: 0.489
Bleu_4: 0.371
computing METEOR score...
METEOR: 0.278
computing Rouge score...
ROUGE_L: 0.575
computing CIDEr score...
CIDEr: 1.198
computing SPICE score...
SPICE: 0.214
computing WMD score...
WMD: 0.258
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr303000_transformer_val.json
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos.pkl
Save training historyes to log/tmp/train_ours/log_refine_transformer_rl/histories_transformer.pkl
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model_26.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer_26.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos_26.pkl
27th Epoch Training starts now!
SPICE evaluation took: 4.150 min
Evaluation Done! 1.0mins 51.483824253082275 seconds
loading annotations into memory...
Done (t=0.83s)
creating index...
index created!
using 5000/5000 predictions
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr306000_transformer_val.json
Loading and preparing results...
DONE (t=0.03s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 46356, 'reflen': 46662, 'guess': [46356, 41356, 36356, 31356], 'correct': [36945, 21346, 10773, 5210]}
ratio: 0.9934422013629722
Bleu_1: 0.792
Bleu_2: 0.637
Bleu_3: 0.493
Bleu_4: 0.375
computing METEOR score...
METEOR: 0.281
computing Rouge score...
ROUGE_L: 0.580
computing CIDEr score...
CIDEr: 1.212
computing SPICE score...
SPICE: 0.216
computing WMD score...
WMD: 0.260
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr306000_transformer_val.json
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos.pkl
Save training historyes to log/tmp/train_ours/log_refine_transformer_rl/histories_transformer.pkl
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model_best.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer_best.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos_best.pkl
update best model at 306000 iteration--27 epoch
SPICE evaluation took: 1.646 min
Evaluation Done! 1.0mins 55.79817795753479 seconds
loading annotations into memory...
Done (t=0.46s)
creating index...
index created!
using 5000/5000 predictions
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr309000_transformer_val.json
Loading and preparing results...
DONE (t=0.03s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 46836, 'reflen': 46959, 'guess': [46836, 41836, 36836, 31836], 'correct': [37154, 21455, 10870, 5234]}
ratio: 0.9973806937966951
Bleu_1: 0.791
Bleu_2: 0.636
Bleu_3: 0.492
Bleu_4: 0.374
computing METEOR score...
METEOR: 0.282
computing Rouge score...
ROUGE_L: 0.579
computing CIDEr score...
CIDEr: 1.216
computing SPICE score...
SPICE: 0.216
computing WMD score...
WMD: 0.260
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr309000_transformer_val.json
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos.pkl
Save training historyes to log/tmp/train_ours/log_refine_transformer_rl/histories_transformer.pkl
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model_best.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer_best.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos_best.pkl
update best model at 309000 iteration--27 epoch
SPICE evaluation took: 2.127 min
Evaluation Done! 1.0mins 11.16012167930603 seconds
loading annotations into memory...
Done (t=0.68s)
creating index...
index created!
using 5000/5000 predictions
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr312000_transformer_val.json
Loading and preparing results...
DONE (t=0.06s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 45876, 'reflen': 46476, 'guess': [45876, 40876, 35876, 30876], 'correct': [36674, 21331, 10778, 5166]}
ratio: 0.987090111025024
Bleu_1: 0.789
Bleu_2: 0.637
Bleu_3: 0.494
Bleu_4: 0.376
computing METEOR score...
METEOR: 0.280
computing Rouge score...
ROUGE_L: 0.578
computing CIDEr score...
CIDEr: 1.215
computing SPICE score...
SPICE: 0.216
computing WMD score...
WMD: 0.259
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr312000_transformer_val.json
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos.pkl
Save training historyes to log/tmp/train_ours/log_refine_transformer_rl/histories_transformer.pkl
SPICE evaluation took: 1.788 min
Evaluation Done! 1.0mins 43.270769119262695 seconds
loading annotations into memory...
Done (t=0.61s)
creating index...
index created!
using 5000/5000 predictions
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr315000_transformer_val.json
Loading and preparing results...
DONE (t=0.02s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 46241, 'reflen': 46651, 'guess': [46241, 41241, 36241, 31241], 'correct': [36852, 21432, 10888, 5183]}
ratio: 0.9912113352339502
Bleu_1: 0.790
Bleu_2: 0.638
Bleu_3: 0.495
Bleu_4: 0.376
computing METEOR score...
METEOR: 0.282
computing Rouge score...
ROUGE_L: 0.577
computing CIDEr score...
CIDEr: 1.219
computing SPICE score...
SPICE: 0.218
computing WMD score...
WMD: 0.259
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr315000_transformer_val.json
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos.pkl
Save training historyes to log/tmp/train_ours/log_refine_transformer_rl/histories_transformer.pkl
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model_best.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer_best.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos_best.pkl
update best model at 315000 iteration--27 epoch
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model_27.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer_27.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos_27.pkl
28th Epoch Training starts now!
SPICE evaluation took: 1.894 min
Evaluation Done! 1.0mins 7.292205333709717 seconds
loading annotations into memory...
Done (t=0.54s)
creating index...
index created!
using 5000/5000 predictions
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr318000_transformer_val.json
Loading and preparing results...
DONE (t=0.04s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 46801, 'reflen': 47097, 'guess': [46801, 41801, 36801, 31801], 'correct': [37208, 21594, 11024, 5308]}
ratio: 0.9937150986262184
Bleu_1: 0.790
Bleu_2: 0.637
Bleu_3: 0.494
Bleu_4: 0.376
computing METEOR score...
METEOR: 0.283
computing Rouge score...
ROUGE_L: 0.580
computing CIDEr score...
CIDEr: 1.227
computing SPICE score...
SPICE: 0.219
computing WMD score...
WMD: 0.260
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr318000_transformer_val.json
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos.pkl
Save training historyes to log/tmp/train_ours/log_refine_transformer_rl/histories_transformer.pkl
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model_best.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer_best.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos_best.pkl
update best model at 318000 iteration--28 epoch
SPICE evaluation took: 2.465 min
Evaluation Done! 0.0mins 54.345295667648315 seconds
loading annotations into memory...
Done (t=0.91s)
creating index...
index created!
using 5000/5000 predictions
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr321000_transformer_val.json
Loading and preparing results...
DONE (t=0.37s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 46736, 'reflen': 46938, 'guess': [46736, 41736, 36736, 31736], 'correct': [37137, 21496, 10880, 5166]}
ratio: 0.9956964506369894
Bleu_1: 0.791
Bleu_2: 0.637
Bleu_3: 0.493
Bleu_4: 0.373
computing METEOR score...
METEOR: 0.281
computing Rouge score...
ROUGE_L: 0.577
computing CIDEr score...
CIDEr: 1.212
computing SPICE score...
SPICE: 0.217
computing WMD score...
WMD: 0.257
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr321000_transformer_val.json
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos.pkl
Save training historyes to log/tmp/train_ours/log_refine_transformer_rl/histories_transformer.pkl
SPICE evaluation took: 2.341 min
Evaluation Done! 1.0mins 28.62805414199829 seconds
loading annotations into memory...
Done (t=0.83s)
creating index...
index created!
using 5000/5000 predictions
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr324000_transformer_val.json
Loading and preparing results...
DONE (t=0.03s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 47134, 'reflen': 47239, 'guess': [47134, 42134, 37134, 32134], 'correct': [37155, 21418, 10916, 5242]}
ratio: 0.9977772603145495
Bleu_1: 0.787
Bleu_2: 0.632
Bleu_3: 0.489
Bleu_4: 0.371
computing METEOR score...
METEOR: 0.281
computing Rouge score...
ROUGE_L: 0.575
computing CIDEr score...
CIDEr: 1.204
computing SPICE score...
SPICE: 0.219
computing WMD score...
WMD: 0.258
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr324000_transformer_val.json
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos.pkl
Save training historyes to log/tmp/train_ours/log_refine_transformer_rl/histories_transformer.pkl
SPICE evaluation took: 2.416 min
Evaluation Done! 1.0mins 28.8279767036438 seconds
loading annotations into memory...
Done (t=0.88s)
creating index...
index created!
using 5000/5000 predictions
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr327000_transformer_val.json
Loading and preparing results...
DONE (t=0.02s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 46649, 'reflen': 46891, 'guess': [46649, 41649, 36649, 31649], 'correct': [37051, 21472, 10874, 5227]}
ratio: 0.9948390949222454
Bleu_1: 0.790
Bleu_2: 0.637
Bleu_3: 0.493
Bleu_4: 0.374
computing METEOR score...
METEOR: 0.282
computing Rouge score...
ROUGE_L: 0.576
computing CIDEr score...
CIDEr: 1.212
computing SPICE score...
SPICE: 0.219
computing WMD score...
WMD: 0.261
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr327000_transformer_val.json
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos.pkl
Save training historyes to log/tmp/train_ours/log_refine_transformer_rl/histories_transformer.pkl
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model_28.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer_28.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos_28.pkl
29th Epoch Training starts now!
SPICE evaluation took: 1.183 min
Evaluation Done! 0.0mins 47.40119743347168 seconds
loading annotations into memory...
Done (t=0.39s)
creating index...
index created!
using 5000/5000 predictions
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr330000_transformer_val.json
Loading and preparing results...
DONE (t=0.02s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 46139, 'reflen': 46615, 'guess': [46139, 41139, 36139, 31139], 'correct': [36832, 21241, 10701, 5013]}
ratio: 0.9897886946261721
Bleu_1: 0.790
Bleu_2: 0.635
Bleu_3: 0.491
Bleu_4: 0.371
computing METEOR score...
METEOR: 0.280
computing Rouge score...
ROUGE_L: 0.577
computing CIDEr score...
CIDEr: 1.211
computing SPICE score...
SPICE: 0.217
computing WMD score...
WMD: 0.259
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr330000_transformer_val.json
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos.pkl
Save training historyes to log/tmp/train_ours/log_refine_transformer_rl/histories_transformer.pkl
SPICE evaluation took: 1.156 min
Evaluation Done! 0.0mins 47.29817509651184 seconds
loading annotations into memory...
Done (t=0.39s)
creating index...
index created!
using 5000/5000 predictions
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr333000_transformer_val.json
Loading and preparing results...
DONE (t=0.02s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 46435, 'reflen': 46706, 'guess': [46435, 41435, 36435, 31435], 'correct': [37030, 21408, 10861, 5182]}
ratio: 0.9941977476127052
Bleu_1: 0.793
Bleu_2: 0.638
Bleu_3: 0.494
Bleu_4: 0.375
computing METEOR score...
METEOR: 0.282
computing Rouge score...
ROUGE_L: 0.578
computing CIDEr score...
CIDEr: 1.227
computing SPICE score...
SPICE: 0.219
computing WMD score...
WMD: 0.261
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr333000_transformer_val.json
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos.pkl
Save training historyes to log/tmp/train_ours/log_refine_transformer_rl/histories_transformer.pkl
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model_best.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer_best.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos_best.pkl
update best model at 333000 iteration--29 epoch
SPICE evaluation took: 1.175 min
Evaluation Done! 0.0mins 44.836047649383545 seconds
loading annotations into memory...
Done (t=0.38s)
creating index...
index created!
using 5000/5000 predictions
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr336000_transformer_val.json
Loading and preparing results...
DONE (t=0.02s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 46522, 'reflen': 46798, 'guess': [46522, 41522, 36522, 31522], 'correct': [37087, 21504, 10888, 5259]}
ratio: 0.994102312064597
Bleu_1: 0.792
Bleu_2: 0.639
Bleu_3: 0.494
Bleu_4: 0.376
computing METEOR score...
METEOR: 0.283
computing Rouge score...
ROUGE_L: 0.579
computing CIDEr score...
CIDEr: 1.228
computing SPICE score...
SPICE: 0.219
computing WMD score...
WMD: 0.262
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr336000_transformer_val.json
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos.pkl
Save training historyes to log/tmp/train_ours/log_refine_transformer_rl/histories_transformer.pkl
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model_best.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer_best.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos_best.pkl
update best model at 336000 iteration--29 epoch
SPICE evaluation took: 1.214 min
Evaluation Done! 0.0mins 48.10908818244934 seconds
loading annotations into memory...
Done (t=0.38s)
creating index...
index created!
using 5000/5000 predictions
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr339000_transformer_val.json
Loading and preparing results...
DONE (t=0.02s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 47349, 'reflen': 47322, 'guess': [47349, 42349, 37349, 32349], 'correct': [37560, 21899, 11150, 5389]}
ratio: 1.000570559147944
Bleu_1: 0.793
Bleu_2: 0.640
Bleu_3: 0.497
Bleu_4: 0.378
computing METEOR score...
METEOR: 0.284
computing Rouge score...
ROUGE_L: 0.580
computing CIDEr score...
CIDEr: 1.226
computing SPICE score...
SPICE: 0.220
computing WMD score...
WMD: 0.260
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr339000_transformer_val.json
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos.pkl
Save training historyes to log/tmp/train_ours/log_refine_transformer_rl/histories_transformer.pkl
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model_29.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer_29.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos_29.pkl
30th Epoch Training starts now!
SPICE evaluation took: 1.208 min
Evaluation Done! 0.0mins 46.19656181335449 seconds
loading annotations into memory...
Done (t=0.38s)
creating index...
index created!
using 5000/5000 predictions
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr342000_transformer_val.json
Loading and preparing results...
DONE (t=0.02s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 46730, 'reflen': 46975, 'guess': [46730, 41730, 36730, 31730], 'correct': [37237, 21644, 11019, 5322]}
ratio: 0.9947844598190316
Bleu_1: 0.793
Bleu_2: 0.640
Bleu_3: 0.496
Bleu_4: 0.378
computing METEOR score...
METEOR: 0.283
computing Rouge score...
ROUGE_L: 0.580
computing CIDEr score...
CIDEr: 1.226
computing SPICE score...
SPICE: 0.219
computing WMD score...
WMD: 0.260
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr342000_transformer_val.json
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos.pkl
Save training historyes to log/tmp/train_ours/log_refine_transformer_rl/histories_transformer.pkl
SPICE evaluation took: 1.209 min
Evaluation Done! 0.0mins 46.87990474700928 seconds
loading annotations into memory...
Done (t=0.38s)
creating index...
index created!
using 5000/5000 predictions
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr345000_transformer_val.json
Loading and preparing results...
DONE (t=0.02s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 47211, 'reflen': 47274, 'guess': [47211, 42211, 37211, 32211], 'correct': [37533, 21864, 11164, 5397]}
ratio: 0.9986673435714982
Bleu_1: 0.794
Bleu_2: 0.641
Bleu_3: 0.497
Bleu_4: 0.379
computing METEOR score...
METEOR: 0.285
computing Rouge score...
ROUGE_L: 0.581
computing CIDEr score...
CIDEr: 1.233
computing SPICE score...
SPICE: 0.220
computing WMD score...
WMD: 0.263
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr345000_transformer_val.json
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos.pkl
Save training historyes to log/tmp/train_ours/log_refine_transformer_rl/histories_transformer.pkl
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model_best.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer_best.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos_best.pkl
update best model at 345000 iteration--30 epoch
SPICE evaluation took: 1.237 min
Evaluation Done! 0.0mins 47.357189893722534 seconds
loading annotations into memory...
Done (t=0.39s)
creating index...
index created!
using 5000/5000 predictions
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr348000_transformer_val.json
Loading and preparing results...
DONE (t=0.02s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 47151, 'reflen': 47243, 'guess': [47151, 42151, 37151, 32151], 'correct': [37455, 21774, 11124, 5334]}
ratio: 0.9980526215523783
Bleu_1: 0.793
Bleu_2: 0.639
Bleu_3: 0.496
Bleu_4: 0.377
computing METEOR score...
METEOR: 0.284
computing Rouge score...
ROUGE_L: 0.579
computing CIDEr score...
CIDEr: 1.226
computing SPICE score...
SPICE: 0.220
computing WMD score...
WMD: 0.261
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr348000_transformer_val.json
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos.pkl
Save training historyes to log/tmp/train_ours/log_refine_transformer_rl/histories_transformer.pkl
SPICE evaluation took: 1.231 min
Evaluation Done! 0.0mins 46.57468819618225 seconds
loading annotations into memory...
Done (t=0.41s)
creating index...
index created!
using 5000/5000 predictions
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr351000_transformer_val.json
Loading and preparing results...
DONE (t=0.03s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 46826, 'reflen': 46998, 'guess': [46826, 41826, 36826, 31826], 'correct': [37328, 21752, 11133, 5359]}
ratio: 0.9963402697986937
Bleu_1: 0.794
Bleu_2: 0.642
Bleu_3: 0.499
Bleu_4: 0.380
computing METEOR score...
METEOR: 0.284
computing Rouge score...
ROUGE_L: 0.580
computing CIDEr score...
CIDEr: 1.235
computing SPICE score...
SPICE: 0.221
computing WMD score...
WMD: 0.262
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr351000_transformer_val.json
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos.pkl
Save training historyes to log/tmp/train_ours/log_refine_transformer_rl/histories_transformer.pkl
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model_best.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer_best.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos_best.pkl
update best model at 351000 iteration--30 epoch
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model_30.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer_30.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos_30.pkl
31th Epoch Training starts now!
SPICE evaluation took: 1.171 min
Evaluation Done! 0.0mins 45.89946103096008 seconds
loading annotations into memory...
Done (t=0.39s)
creating index...
index created!
using 5000/5000 predictions
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr354000_transformer_val.json
Loading and preparing results...
DONE (t=0.04s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 46975, 'reflen': 47096, 'guess': [46975, 41975, 36975, 31975], 'correct': [37372, 21701, 11078, 5324]}
ratio: 0.9974307796840285
Bleu_1: 0.794
Bleu_2: 0.640
Bleu_3: 0.496
Bleu_4: 0.378
computing METEOR score...
METEOR: 0.284
computing Rouge score...
ROUGE_L: 0.578
computing CIDEr score...
CIDEr: 1.227
computing SPICE score...
SPICE: 0.220
computing WMD score...
WMD: 0.262
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr354000_transformer_val.json
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos.pkl
Save training historyes to log/tmp/train_ours/log_refine_transformer_rl/histories_transformer.pkl
SPICE evaluation took: 1.472 min
Evaluation Done! 0.0mins 47.108630418777466 seconds
loading annotations into memory...
Done (t=0.42s)
creating index...
index created!
using 5000/5000 predictions
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr357000_transformer_val.json
Loading and preparing results...
DONE (t=0.03s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 47160, 'reflen': 47248, 'guess': [47160, 42160, 37160, 32160], 'correct': [37545, 21861, 11208, 5428]}
ratio: 0.9981374873010287
Bleu_1: 0.795
Bleu_2: 0.641
Bleu_3: 0.498
Bleu_4: 0.380
computing METEOR score...
METEOR: 0.285
computing Rouge score...
ROUGE_L: 0.582
computing CIDEr score...
CIDEr: 1.235
computing SPICE score...
SPICE: 0.221
computing WMD score...
WMD: 0.263
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr357000_transformer_val.json
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos.pkl
Save training historyes to log/tmp/train_ours/log_refine_transformer_rl/histories_transformer.pkl
SPICE evaluation took: 1.414 min
Evaluation Done! 0.0mins 45.74300217628479 seconds
loading annotations into memory...
Done (t=0.40s)
creating index...
index created!
using 5000/5000 predictions
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr360000_transformer_val.json
Loading and preparing results...
DONE (t=0.02s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 47284, 'reflen': 47298, 'guess': [47284, 42284, 37284, 32284], 'correct': [37652, 21926, 11182, 5357]}
ratio: 0.9997040043976279
Bleu_1: 0.796
Bleu_2: 0.642
Bleu_3: 0.498
Bleu_4: 0.379
computing METEOR score...
METEOR: 0.285
computing Rouge score...
ROUGE_L: 0.581
computing CIDEr score...
CIDEr: 1.234
computing SPICE score...
SPICE: 0.221
computing WMD score...
WMD: 0.261
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr360000_transformer_val.json
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos.pkl
Save training historyes to log/tmp/train_ours/log_refine_transformer_rl/histories_transformer.pkl
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model_31.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer_31.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos_31.pkl
32th Epoch Training starts now!
SPICE evaluation took: 1.438 min
Evaluation Done! 0.0mins 46.31344556808472 seconds
loading annotations into memory...
Done (t=0.41s)
creating index...
index created!
using 5000/5000 predictions
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr363000_transformer_val.json
Loading and preparing results...
DONE (t=0.03s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 47040, 'reflen': 47161, 'guess': [47040, 42040, 37040, 32040], 'correct': [37545, 21875, 11167, 5373]}
ratio: 0.9974343207310915
Bleu_1: 0.796
Bleu_2: 0.643
Bleu_3: 0.499
Bleu_4: 0.380
computing METEOR score...
METEOR: 0.285
computing Rouge score...
ROUGE_L: 0.581
computing CIDEr score...
CIDEr: 1.238
computing SPICE score...
SPICE: 0.222
computing WMD score...
WMD: 0.263
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr363000_transformer_val.json
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos.pkl
Save training historyes to log/tmp/train_ours/log_refine_transformer_rl/histories_transformer.pkl
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model_best.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer_best.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos_best.pkl
update best model at 363000 iteration--32 epoch
SPICE evaluation took: 1.219 min
Evaluation Done! 0.0mins 45.741302728652954 seconds
loading annotations into memory...
Done (t=0.45s)
creating index...
index created!
using 5000/5000 predictions
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr366000_transformer_val.json
Loading and preparing results...
DONE (t=0.03s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 46697, 'reflen': 46935, 'guess': [46697, 41697, 36697, 31697], 'correct': [37468, 21904, 11197, 5377]}
ratio: 0.9949291573452436
Bleu_1: 0.798
Bleu_2: 0.646
Bleu_3: 0.502
Bleu_4: 0.382
computing METEOR score...
METEOR: 0.285
computing Rouge score...
ROUGE_L: 0.582
computing CIDEr score...
CIDEr: 1.245
computing SPICE score...
SPICE: 0.222
computing WMD score...
WMD: 0.265
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr366000_transformer_val.json
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos.pkl
Save training historyes to log/tmp/train_ours/log_refine_transformer_rl/histories_transformer.pkl
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model_best.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer_best.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos_best.pkl
update best model at 366000 iteration--32 epoch
SPICE evaluation took: 1.347 min
Evaluation Done! 0.0mins 47.916558504104614 seconds
loading annotations into memory...
Done (t=0.48s)
creating index...
index created!
using 5000/5000 predictions
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr369000_transformer_val.json
Loading and preparing results...
DONE (t=0.03s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 46968, 'reflen': 47169, 'guess': [46968, 41968, 36968, 31968], 'correct': [37543, 21895, 11092, 5287]}
ratio: 0.9957387267060783
Bleu_1: 0.796
Bleu_2: 0.643
Bleu_3: 0.498
Bleu_4: 0.378
computing METEOR score...
METEOR: 0.284
computing Rouge score...
ROUGE_L: 0.580
computing CIDEr score...
CIDEr: 1.237
computing SPICE score...
SPICE: 0.223
computing WMD score...
WMD: 0.263
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr369000_transformer_val.json
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos.pkl
Save training historyes to log/tmp/train_ours/log_refine_transformer_rl/histories_transformer.pkl
SPICE evaluation took: 1.375 min
Evaluation Done! 0.0mins 49.83994102478027 seconds
loading annotations into memory...
Done (t=0.40s)
creating index...
index created!
using 5000/5000 predictions
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr372000_transformer_val.json
Loading and preparing results...
DONE (t=0.03s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 47229, 'reflen': 47277, 'guess': [47229, 42229, 37229, 32229], 'correct': [37637, 21977, 11243, 5408]}
ratio: 0.9989847071514479
Bleu_1: 0.796
Bleu_2: 0.643
Bleu_3: 0.500
Bleu_4: 0.380
computing METEOR score...
METEOR: 0.284
computing Rouge score...
ROUGE_L: 0.581
computing CIDEr score...
CIDEr: 1.239
computing SPICE score...
SPICE: 0.222
computing WMD score...
WMD: 0.262
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr372000_transformer_val.json
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos.pkl
Save training historyes to log/tmp/train_ours/log_refine_transformer_rl/histories_transformer.pkl
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model_32.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer_32.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos_32.pkl
33th Epoch Training starts now!
SPICE evaluation took: 1.562 min
Evaluation Done! 0.0mins 57.62076735496521 seconds
loading annotations into memory...
Done (t=0.42s)
creating index...
index created!
using 5000/5000 predictions
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr375000_transformer_val.json
Loading and preparing results...
DONE (t=0.05s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 47449, 'reflen': 47392, 'guess': [47449, 42449, 37449, 32449], 'correct': [37676, 21893, 11217, 5434]}
ratio: 1.0012027346387364
Bleu_1: 0.794
Bleu_2: 0.640
Bleu_3: 0.497
Bleu_4: 0.379
computing METEOR score...
METEOR: 0.285
computing Rouge score...
ROUGE_L: 0.579
computing CIDEr score...
CIDEr: 1.236
computing SPICE score...
SPICE: 0.224
computing WMD score...
WMD: 0.264
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr375000_transformer_val.json
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos.pkl
Save training historyes to log/tmp/train_ours/log_refine_transformer_rl/histories_transformer.pkl
SPICE evaluation took: 1.493 min
Evaluation Done! 0.0mins 56.65544939041138 seconds
loading annotations into memory...
Done (t=0.42s)
creating index...
index created!
using 5000/5000 predictions
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr378000_transformer_val.json
Loading and preparing results...
DONE (t=0.03s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 47401, 'reflen': 47381, 'guess': [47401, 42401, 37401, 32401], 'correct': [37833, 22096, 11287, 5447]}
ratio: 1.0004221101285116
Bleu_1: 0.798
Bleu_2: 0.645
Bleu_3: 0.501
Bleu_4: 0.381
computing METEOR score...
METEOR: 0.285
computing Rouge score...
ROUGE_L: 0.581
computing CIDEr score...
CIDEr: 1.243
computing SPICE score...
SPICE: 0.224
computing WMD score...
WMD: 0.264
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr378000_transformer_val.json
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos.pkl
Save training historyes to log/tmp/train_ours/log_refine_transformer_rl/histories_transformer.pkl
SPICE evaluation took: 1.767 min
Evaluation Done! 1.0mins 1.4605050086975098 seconds
loading annotations into memory...
Done (t=0.46s)
creating index...
index created!
using 5000/5000 predictions
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr381000_transformer_val.json
Loading and preparing results...
DONE (t=0.61s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 46926, 'reflen': 47062, 'guess': [46926, 41926, 36926, 31926], 'correct': [37592, 21941, 11204, 5421]}
ratio: 0.9971101950618122
Bleu_1: 0.799
Bleu_2: 0.646
Bleu_3: 0.501
Bleu_4: 0.382
computing METEOR score...
METEOR: 0.285
computing Rouge score...
ROUGE_L: 0.582
computing CIDEr score...
CIDEr: 1.244
computing SPICE score...
SPICE: 0.223
computing WMD score...
WMD: 0.264
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr381000_transformer_val.json
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos.pkl
Save training historyes to log/tmp/train_ours/log_refine_transformer_rl/histories_transformer.pkl
SPICE evaluation took: 1.526 min
Evaluation Done! 0.0mins 54.79380559921265 seconds
loading annotations into memory...
Done (t=0.41s)
creating index...
index created!
using 5000/5000 predictions
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr384000_transformer_val.json
Loading and preparing results...
DONE (t=0.03s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 46957, 'reflen': 47116, 'guess': [46957, 41957, 36957, 31957], 'correct': [37578, 21937, 11212, 5396]}
ratio: 0.9966253501994865
Bleu_1: 0.798
Bleu_2: 0.645
Bleu_3: 0.501
Bleu_4: 0.381
computing METEOR score...
METEOR: 0.285
computing Rouge score...
ROUGE_L: 0.581
computing CIDEr score...
CIDEr: 1.245
computing SPICE score...
SPICE: 0.223
computing WMD score...
WMD: 0.264
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr384000_transformer_val.json
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos.pkl
Save training historyes to log/tmp/train_ours/log_refine_transformer_rl/histories_transformer.pkl
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model_33.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer_33.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos_33.pkl
34th Epoch Training starts now!
SPICE evaluation took: 1.414 min
Evaluation Done! 0.0mins 54.2540225982666 seconds
loading annotations into memory...
Done (t=0.40s)
creating index...
index created!
using 5000/5000 predictions
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr387000_transformer_val.json
Loading and preparing results...
DONE (t=0.03s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 46936, 'reflen': 47090, 'guess': [46936, 41936, 36936, 31936], 'correct': [37535, 21953, 11238, 5448]}
ratio: 0.9967296665958592
Bleu_1: 0.797
Bleu_2: 0.645
Bleu_3: 0.501
Bleu_4: 0.383
computing METEOR score...
METEOR: 0.285
computing Rouge score...
ROUGE_L: 0.581
computing CIDEr score...
CIDEr: 1.245
computing SPICE score...
SPICE: 0.222
computing WMD score...
WMD: 0.263
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr387000_transformer_val.json
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos.pkl
Save training historyes to log/tmp/train_ours/log_refine_transformer_rl/histories_transformer.pkl
SPICE evaluation took: 1.426 min
Evaluation Done! 0.0mins 53.36040163040161 seconds
loading annotations into memory...
Done (t=0.40s)
creating index...
index created!
using 5000/5000 predictions
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr390000_transformer_val.json
Loading and preparing results...
DONE (t=0.03s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 47150, 'reflen': 47187, 'guess': [47150, 42150, 37150, 32150], 'correct': [37688, 22005, 11258, 5432]}
ratio: 0.9992158857312184
Bleu_1: 0.799
Bleu_2: 0.645
Bleu_3: 0.502
Bleu_4: 0.382
computing METEOR score...
METEOR: 0.285
computing Rouge score...
ROUGE_L: 0.582
computing CIDEr score...
CIDEr: 1.246
computing SPICE score...
SPICE: 0.223
computing WMD score...
WMD: 0.262
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr390000_transformer_val.json
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos.pkl
Save training historyes to log/tmp/train_ours/log_refine_transformer_rl/histories_transformer.pkl
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model_best.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer_best.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos_best.pkl
update best model at 390000 iteration--34 epoch
SPICE evaluation took: 1.514 min
Evaluation Done! 0.0mins 55.59686899185181 seconds
loading annotations into memory...
Done (t=0.40s)
creating index...
index created!
using 5000/5000 predictions
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr393000_transformer_val.json
Loading and preparing results...
DONE (t=0.03s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 47054, 'reflen': 47124, 'guess': [47054, 42054, 37054, 32054], 'correct': [37667, 22068, 11299, 5470]}
ratio: 0.9985145573380656
Bleu_1: 0.799
Bleu_2: 0.647
Bleu_3: 0.503
Bleu_4: 0.384
computing METEOR score...
METEOR: 0.285
computing Rouge score...
ROUGE_L: 0.583
computing CIDEr score...
CIDEr: 1.246
computing SPICE score...
SPICE: 0.223
computing WMD score...
WMD: 0.263
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr393000_transformer_val.json
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos.pkl
Save training historyes to log/tmp/train_ours/log_refine_transformer_rl/histories_transformer.pkl
SPICE evaluation took: 1.557 min
Evaluation Done! 0.0mins 56.308767795562744 seconds
loading annotations into memory...
Done (t=0.41s)
creating index...
index created!
using 5000/5000 predictions
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr396000_transformer_val.json
Loading and preparing results...
DONE (t=0.03s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 47197, 'reflen': 47235, 'guess': [47197, 42197, 37197, 32197], 'correct': [37687, 22019, 11275, 5414]}
ratio: 0.9991955118026676
Bleu_1: 0.798
Bleu_2: 0.645
Bleu_3: 0.501
Bleu_4: 0.381
computing METEOR score...
METEOR: 0.285
computing Rouge score...
ROUGE_L: 0.581
computing CIDEr score...
CIDEr: 1.241
computing SPICE score...
SPICE: 0.223
computing WMD score...
WMD: 0.263
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr396000_transformer_val.json
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos.pkl
Save training historyes to log/tmp/train_ours/log_refine_transformer_rl/histories_transformer.pkl
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model_34.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer_34.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos_34.pkl
35th Epoch Training starts now!
SPICE evaluation took: 1.556 min
Evaluation Done! 0.0mins 56.17744016647339 seconds
loading annotations into memory...
Done (t=0.42s)
creating index...
index created!
using 5000/5000 predictions
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr399000_transformer_val.json
Loading and preparing results...
DONE (t=0.02s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 47057, 'reflen': 47144, 'guess': [47057, 42057, 37057, 32057], 'correct': [37690, 22093, 11353, 5514]}
ratio: 0.9981545901917318
Bleu_1: 0.799
Bleu_2: 0.647
Bleu_3: 0.504
Bleu_4: 0.385
computing METEOR score...
METEOR: 0.286
computing Rouge score...
ROUGE_L: 0.583
computing CIDEr score...
CIDEr: 1.251
computing SPICE score...
SPICE: 0.223
computing WMD score...
WMD: 0.264
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr399000_transformer_val.json
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos.pkl
Save training historyes to log/tmp/train_ours/log_refine_transformer_rl/histories_transformer.pkl
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model_best.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer_best.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos_best.pkl
update best model at 399000 iteration--35 epoch
SPICE evaluation took: 1.632 min
Evaluation Done! 0.0mins 55.70068645477295 seconds
loading annotations into memory...
Done (t=0.43s)
creating index...
index created!
using 5000/5000 predictions
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr402000_transformer_val.json
Loading and preparing results...
DONE (t=0.03s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 47388, 'reflen': 47345, 'guess': [47388, 42388, 37388, 32388], 'correct': [37799, 22106, 11324, 5511]}
ratio: 1.0009082268454748
Bleu_1: 0.798
Bleu_2: 0.645
Bleu_3: 0.501
Bleu_4: 0.383
computing METEOR score...
METEOR: 0.285
computing Rouge score...
ROUGE_L: 0.581
computing CIDEr score...
CIDEr: 1.244
computing SPICE score...
SPICE: 0.224
computing WMD score...
WMD: 0.263
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr402000_transformer_val.json
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos.pkl
Save training historyes to log/tmp/train_ours/log_refine_transformer_rl/histories_transformer.pkl
SPICE evaluation took: 1.338 min
Evaluation Done! 0.0mins 46.572505950927734 seconds
loading annotations into memory...
Done (t=0.36s)
creating index...
index created!
using 5000/5000 predictions
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr405000_transformer_val.json
Loading and preparing results...
DONE (t=0.03s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 47110, 'reflen': 47169, 'guess': [47110, 42110, 37110, 32110], 'correct': [37644, 22019, 11267, 5427]}
ratio: 0.9987491784858489
Bleu_1: 0.798
Bleu_2: 0.646
Bleu_3: 0.502
Bleu_4: 0.382
computing METEOR score...
METEOR: 0.285
computing Rouge score...
ROUGE_L: 0.582
computing CIDEr score...
CIDEr: 1.244
computing SPICE score...
SPICE: 0.223
computing WMD score...
WMD: 0.263
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr405000_transformer_val.json
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos.pkl
Save training historyes to log/tmp/train_ours/log_refine_transformer_rl/histories_transformer.pkl
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model_35.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer_35.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos_35.pkl
36th Epoch Training starts now!
SPICE evaluation took: 1.328 min
Evaluation Done! 0.0mins 53.27822971343994 seconds
loading annotations into memory...
Done (t=0.40s)
creating index...
index created!
using 5000/5000 predictions
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr408000_transformer_val.json
Loading and preparing results...
DONE (t=0.02s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 46941, 'reflen': 47069, 'guess': [46941, 41941, 36941, 31941], 'correct': [37542, 21964, 11248, 5430]}
ratio: 0.9972805880728082
Bleu_1: 0.798
Bleu_2: 0.645
Bleu_3: 0.502
Bleu_4: 0.383
computing METEOR score...
METEOR: 0.285
computing Rouge score...
ROUGE_L: 0.582
computing CIDEr score...
CIDEr: 1.242
computing SPICE score...
SPICE: 0.222
computing WMD score...
WMD: 0.262
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr408000_transformer_val.json
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos.pkl
Save training historyes to log/tmp/train_ours/log_refine_transformer_rl/histories_transformer.pkl
SPICE evaluation took: 1.304 min
Evaluation Done! 0.0mins 51.41458344459534 seconds
loading annotations into memory...
Done (t=0.40s)
creating index...
index created!
using 5000/5000 predictions
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr411000_transformer_val.json
Loading and preparing results...
DONE (t=0.03s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 47173, 'reflen': 47183, 'guess': [47173, 42173, 37173, 32173], 'correct': [37648, 22043, 11313, 5457]}
ratio: 0.9997880592586101
Bleu_1: 0.798
Bleu_2: 0.646
Bleu_3: 0.502
Bleu_4: 0.383
computing METEOR score...
METEOR: 0.285
computing Rouge score...
ROUGE_L: 0.582
computing CIDEr score...
CIDEr: 1.244
computing SPICE score...
SPICE: 0.223
computing WMD score...
WMD: 0.263
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr411000_transformer_val.json
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos.pkl
Save training historyes to log/tmp/train_ours/log_refine_transformer_rl/histories_transformer.pkl
SPICE evaluation took: 1.256 min
Evaluation Done! 0.0mins 51.8317756652832 seconds
loading annotations into memory...
Done (t=0.41s)
creating index...
index created!
using 5000/5000 predictions
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr414000_transformer_val.json
Loading and preparing results...
DONE (t=0.03s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 47156, 'reflen': 47185, 'guess': [47156, 42156, 37156, 32156], 'correct': [37662, 22033, 11263, 5412]}
ratio: 0.9993853979018544
Bleu_1: 0.798
Bleu_2: 0.646
Bleu_3: 0.502
Bleu_4: 0.382
computing METEOR score...
METEOR: 0.285
computing Rouge score...
ROUGE_L: 0.582
computing CIDEr score...
CIDEr: 1.245
computing SPICE score...
SPICE: 0.223
computing WMD score...
WMD: 0.262
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr414000_transformer_val.json
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos.pkl
Save training historyes to log/tmp/train_ours/log_refine_transformer_rl/histories_transformer.pkl
SPICE evaluation took: 1.276 min
Evaluation Done! 0.0mins 52.19202995300293 seconds
loading annotations into memory...
Done (t=0.41s)
creating index...
index created!
using 5000/5000 predictions
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr417000_transformer_val.json
Loading and preparing results...
DONE (t=0.03s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 46972, 'reflen': 47098, 'guess': [46972, 41972, 36972, 31972], 'correct': [37522, 21939, 11197, 5391]}
ratio: 0.9973247271646143
Bleu_1: 0.797
Bleu_2: 0.644
Bleu_3: 0.501
Bleu_4: 0.381
computing METEOR score...
METEOR: 0.285
computing Rouge score...
ROUGE_L: 0.582
computing CIDEr score...
CIDEr: 1.244
computing SPICE score...
SPICE: 0.224
computing WMD score...
WMD: 0.263
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr417000_transformer_val.json
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos.pkl
Save training historyes to log/tmp/train_ours/log_refine_transformer_rl/histories_transformer.pkl
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model_36.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer_36.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos_36.pkl
37th Epoch Training starts now!
SPICE evaluation took: 1.285 min
Evaluation Done! 0.0mins 52.325234174728394 seconds
loading annotations into memory...
Done (t=0.41s)
creating index...
index created!
using 5000/5000 predictions
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr420000_transformer_val.json
Loading and preparing results...
DONE (t=0.02s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 47058, 'reflen': 47153, 'guess': [47058, 42058, 37058, 32058], 'correct': [37626, 22028, 11292, 5458]}
ratio: 0.9979852819544675
Bleu_1: 0.798
Bleu_2: 0.646
Bleu_3: 0.502
Bleu_4: 0.383
computing METEOR score...
METEOR: 0.285
computing Rouge score...
ROUGE_L: 0.583
computing CIDEr score...
CIDEr: 1.248
computing SPICE score...
SPICE: 0.224
computing WMD score...
WMD: 0.263
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr420000_transformer_val.json
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos.pkl
Save training historyes to log/tmp/train_ours/log_refine_transformer_rl/histories_transformer.pkl
SPICE evaluation took: 1.423 min
Evaluation Done! 0.0mins 54.43985033035278 seconds
loading annotations into memory...
Done (t=0.41s)
creating index...
index created!
using 5000/5000 predictions
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr423000_transformer_val.json
Loading and preparing results...
DONE (t=0.03s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 47072, 'reflen': 47123, 'guess': [47072, 42072, 37072, 32072], 'correct': [37610, 21995, 11235, 5411]}
ratio: 0.9989177259512129
Bleu_1: 0.798
Bleu_2: 0.646
Bleu_3: 0.502
Bleu_4: 0.382
computing METEOR score...
METEOR: 0.285
computing Rouge score...
ROUGE_L: 0.582
computing CIDEr score...
CIDEr: 1.247
computing SPICE score...
SPICE: 0.223
computing WMD score...
WMD: 0.263
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr423000_transformer_val.json
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos.pkl
Save training historyes to log/tmp/train_ours/log_refine_transformer_rl/histories_transformer.pkl
SPICE evaluation took: 1.308 min
Evaluation Done! 0.0mins 49.923694133758545 seconds
loading annotations into memory...
Done (t=0.41s)
creating index...
index created!
using 5000/5000 predictions
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr426000_transformer_val.json
Loading and preparing results...
DONE (t=0.02s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 47139, 'reflen': 47167, 'guess': [47139, 42139, 37139, 32139], 'correct': [37629, 21987, 11227, 5413]}
ratio: 0.9994063646193102
Bleu_1: 0.798
Bleu_2: 0.645
Bleu_3: 0.501
Bleu_4: 0.381
computing METEOR score...
METEOR: 0.285
computing Rouge score...
ROUGE_L: 0.582
computing CIDEr score...
CIDEr: 1.243
computing SPICE score...
SPICE: 0.223
computing WMD score...
WMD: 0.263
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr426000_transformer_val.json
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos.pkl
Save training historyes to log/tmp/train_ours/log_refine_transformer_rl/histories_transformer.pkl
SPICE evaluation took: 1.283 min
Evaluation Done! 0.0mins 50.78012681007385 seconds
loading annotations into memory...
Done (t=0.42s)
creating index...
index created!
using 5000/5000 predictions
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr429000_transformer_val.json
Loading and preparing results...
DONE (t=0.02s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 47021, 'reflen': 47115, 'guess': [47021, 42021, 37021, 32021], 'correct': [37576, 21986, 11225, 5402]}
ratio: 0.9980048816724824
Bleu_1: 0.798
Bleu_2: 0.645
Bleu_3: 0.501
Bleu_4: 0.382
computing METEOR score...
METEOR: 0.285
computing Rouge score...
ROUGE_L: 0.582
computing CIDEr score...
CIDEr: 1.244
computing SPICE score...
SPICE: 0.224
computing WMD score...
WMD: 0.263
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr429000_transformer_val.json
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos.pkl
Save training historyes to log/tmp/train_ours/log_refine_transformer_rl/histories_transformer.pkl
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model_37.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer_37.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos_37.pkl
38th Epoch Training starts now!
SPICE evaluation took: 1.272 min
Evaluation Done! 0.0mins 51.26617360115051 seconds
loading annotations into memory...
Done (t=0.42s)
creating index...
index created!
using 5000/5000 predictions
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr432000_transformer_val.json
Loading and preparing results...
DONE (t=0.02s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 46892, 'reflen': 47045, 'guess': [46892, 41892, 36892, 31892], 'correct': [37501, 21948, 11227, 5393]}
ratio: 0.9967477946646617
Bleu_1: 0.797
Bleu_2: 0.645
Bleu_3: 0.502
Bleu_4: 0.382
computing METEOR score...
METEOR: 0.285
computing Rouge score...
ROUGE_L: 0.582
computing CIDEr score...
CIDEr: 1.243
computing SPICE score...
SPICE: 0.223
computing WMD score...
WMD: 0.263
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr432000_transformer_val.json
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos.pkl
Save training historyes to log/tmp/train_ours/log_refine_transformer_rl/histories_transformer.pkl
SPICE evaluation took: 1.247 min
Evaluation Done! 0.0mins 52.73938226699829 seconds
loading annotations into memory...
Done (t=0.41s)
creating index...
index created!
using 5000/5000 predictions
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr435000_transformer_val.json
Loading and preparing results...
DONE (t=0.03s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 46979, 'reflen': 47081, 'guess': [46979, 41979, 36979, 31979], 'correct': [37571, 22011, 11261, 5408]}
ratio: 0.9978335209532296
Bleu_1: 0.798
Bleu_2: 0.646
Bleu_3: 0.502
Bleu_4: 0.383
computing METEOR score...
METEOR: 0.285
computing Rouge score...
ROUGE_L: 0.582
computing CIDEr score...
CIDEr: 1.244
computing SPICE score...
SPICE: 0.224
computing WMD score...
WMD: 0.263
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr435000_transformer_val.json
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos.pkl
Save training historyes to log/tmp/train_ours/log_refine_transformer_rl/histories_transformer.pkl
SPICE evaluation took: 1.279 min
Evaluation Done! 0.0mins 52.576112508773804 seconds
loading annotations into memory...
Done (t=0.42s)
creating index...
index created!
using 5000/5000 predictions
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr438000_transformer_val.json
Loading and preparing results...
DONE (t=0.03s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 46965, 'reflen': 47068, 'guess': [46965, 41965, 36965, 31965], 'correct': [37545, 21991, 11241, 5401]}
ratio: 0.9978116767230178
Bleu_1: 0.798
Bleu_2: 0.646
Bleu_3: 0.502
Bleu_4: 0.382
computing METEOR score...
METEOR: 0.285
computing Rouge score...
ROUGE_L: 0.582
computing CIDEr score...
CIDEr: 1.244
computing SPICE score...
SPICE: 0.223
computing WMD score...
WMD: 0.263
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr438000_transformer_val.json
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos.pkl
Save training historyes to log/tmp/train_ours/log_refine_transformer_rl/histories_transformer.pkl
SPICE evaluation took: 1.315 min
Evaluation Done! 1.0mins 27.686142921447754 seconds
loading annotations into memory...
Done (t=0.58s)
creating index...
index created!
using 5000/5000 predictions
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr441000_transformer_val.json
Loading and preparing results...
DONE (t=0.02s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 47033, 'reflen': 47124, 'guess': [47033, 42033, 37033, 32033], 'correct': [37606, 22016, 11256, 5411]}
ratio: 0.9980689245394917
Bleu_1: 0.798
Bleu_2: 0.646
Bleu_3: 0.502
Bleu_4: 0.382
computing METEOR score...
METEOR: 0.285
computing Rouge score...
ROUGE_L: 0.582
computing CIDEr score...
CIDEr: 1.245
computing SPICE score...
SPICE: 0.224
computing WMD score...
WMD: 0.263
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr441000_transformer_val.json
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos.pkl
Save training historyes to log/tmp/train_ours/log_refine_transformer_rl/histories_transformer.pkl
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model_38.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer_38.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos_38.pkl
39th Epoch Training starts now!
SPICE evaluation took: 1.360 min
Evaluation Done! 0.0mins 52.29903602600098 seconds
loading annotations into memory...
Done (t=0.41s)
creating index...
index created!
using 5000/5000 predictions
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr444000_transformer_val.json
Loading and preparing results...
DONE (t=0.02s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 47112, 'reflen': 47170, 'guess': [47112, 42112, 37112, 32112], 'correct': [37647, 22027, 11250, 5407]}
ratio: 0.9987704049183592
Bleu_1: 0.798
Bleu_2: 0.646
Bleu_3: 0.502
Bleu_4: 0.382
computing METEOR score...
METEOR: 0.285
computing Rouge score...
ROUGE_L: 0.582
computing CIDEr score...
CIDEr: 1.243
computing SPICE score...
SPICE: 0.224
computing WMD score...
WMD: 0.263
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr444000_transformer_val.json
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos.pkl
Save training historyes to log/tmp/train_ours/log_refine_transformer_rl/histories_transformer.pkl
SPICE evaluation took: 1.282 min
Evaluation Done! 0.0mins 51.67255139350891 seconds
loading annotations into memory...
Done (t=0.42s)
creating index...
index created!
using 5000/5000 predictions
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr447000_transformer_val.json
Loading and preparing results...
DONE (t=0.02s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 47074, 'reflen': 47141, 'guess': [47074, 42074, 37074, 32074], 'correct': [37604, 21977, 11231, 5402]}
ratio: 0.9985787318894169
Bleu_1: 0.798
Bleu_2: 0.645
Bleu_3: 0.501
Bleu_4: 0.381
computing METEOR score...
METEOR: 0.285
computing Rouge score...
ROUGE_L: 0.582
computing CIDEr score...
CIDEr: 1.242
computing SPICE score...
SPICE: 0.223
computing WMD score...
WMD: 0.263
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr447000_transformer_val.json
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos.pkl
Save training historyes to log/tmp/train_ours/log_refine_transformer_rl/histories_transformer.pkl
SPICE evaluation took: 1.322 min
Evaluation Done! 0.0mins 51.76233386993408 seconds
loading annotations into memory...
Done (t=0.40s)
creating index...
index created!
using 5000/5000 predictions
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr450000_transformer_val.json
Loading and preparing results...
DONE (t=0.02s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 47092, 'reflen': 47155, 'guess': [47092, 42092, 37092, 32092], 'correct': [37603, 21985, 11223, 5385]}
ratio: 0.9986639804898527
Bleu_1: 0.797
Bleu_2: 0.645
Bleu_3: 0.501
Bleu_4: 0.381
computing METEOR score...
METEOR: 0.285
computing Rouge score...
ROUGE_L: 0.582
computing CIDEr score...
CIDEr: 1.241
computing SPICE score...
SPICE: 0.223
computing WMD score...
WMD: 0.263
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr450000_transformer_val.json
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos.pkl
Save training historyes to log/tmp/train_ours/log_refine_transformer_rl/histories_transformer.pkl
SPICE evaluation took: 1.208 min
Evaluation Done! 0.0mins 46.685017108917236 seconds
loading annotations into memory...
Done (t=0.40s)
creating index...
index created!
using 5000/5000 predictions
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr453000_transformer_val.json
Loading and preparing results...
DONE (t=0.03s)
creating index...
index created!
tokenization...
setting up scorers...
computing Bleu score...
{'testlen': 47092, 'reflen': 47161, 'guess': [47092, 42092, 37092, 32092], 'correct': [37609, 21987, 11227, 5393]}
ratio: 0.9985369266978861
Bleu_1: 0.797
Bleu_2: 0.645
Bleu_3: 0.501
Bleu_4: 0.381
computing METEOR score...
METEOR: 0.285
computing Rouge score...
ROUGE_L: 0.582
computing CIDEr score...
CIDEr: 1.242
computing SPICE score...
SPICE: 0.223
computing WMD score...
WMD: 0.263
Write prediction results to eval_results/single/train_ours_log_refine_transformer_rl_model_itr453000_transformer_val.json
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos.pkl
Save training historyes to log/tmp/train_ours/log_refine_transformer_rl/histories_transformer.pkl
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model_39.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer_39.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos_39.pkl
epoch 40 break all
Save model state to log/tmp/train_ours/log_refine_transformer_rl/model.pth
Save model optimizer to log/tmp/train_ours/log_refine_transformer_rl/optimizer.pth
Save training information to log/tmp/train_ours/log_refine_transformer_rl/infos.pkl
Terminating BlobFetcher
